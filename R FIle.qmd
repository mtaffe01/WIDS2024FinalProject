---
title: "testibng"
format: html
editor: visual
---

### Loading Packages

```{r}
library(tidytuesdayR)
library(tidyverse)
```

### Gathering Data

```{r}
# Union Data
tuesdata <- tidytuesdayR::tt_load(2023, week = 36)

demographics <- tuesdata$demographics
wages <- tuesdata$wages
states <- tuesdata$states


# Election Data
tuesdata <- tidytuesdayR::tt_load(2023, week = 45)

house <- tuesdata$house
```

### Cleaning Data

First, lets get an idea of what our data looks like.

```{r}
head(demographics)
head(wages)
head(states)
head(house)
```

From the head() function we can already see some tidying that needs to be done, mostly in the `house` table. First, to make data analysis easier we will need to combine the `states` and `house` table; this will be done on the year and state columns. however, the state column in the house data set is in uppercase, compared to sentence case in the states table. Next, R has read district in as a string column rather than a numeric column.

Next we will look at a quick summary of the data to find very obvious trends.

```{r}
summary(demographics)
```


```{r}
summary(wages)
```
```{r}
summary(states)
```
```{r}
summary(house)
```



#### Items that need to be done

-   Sentence case to house table
-   fix `district` in the house table

### EDA

```{r}
states |> 
  ggplot(aes(x = year, y = p_covered, color = state)) +
  geom_point()
```

```{r}
house <- house |>
  mutate(state = str_to_sentence(state))
```

```{r}
states |> 
  filter(sector == "Total") |> 
  left_join(house, by = c("year", "state")) |> 
  filter(party == "DEMOCRAT" | party == "REPUBLICAN") |> 
  filter(year > 2012) |> 
  ggplot(aes(x = party, y = p_members)) +
  geom_boxplot()
```

```{r}
test <- states |> 
  filter(sector == "Total") |> 
  left_join(house, by = c("year", "state")) |> 
  filter(party == "DEMOCRAT" | party == "REPUBLICAN") |> 
  filter(year > 2012)
```

```{r}
t.test(p_members ~ party, data = test, conf.level = .9)
```
