---
title: "Comparing Interactions Between Collective Bargaining, Wages and Income, and House of Representative Elections"
author: 
  - Ramiro Arevalo^[American University]
  - Melanie Klein^[American University]
  - Michael Taffe^[American University]

format: 
  pdf:
    number-sections: true
    toc: false
    geometry: 
      - top=3cm
date: 2024-01-12
date-format: iso
documentclass: article
editor: source
abstract: "For our project, our goal is to examine the relationships between collective bargaining agreements, U.S. house election results, and incomes/wages of Americans. The motivation for this project is the rise in wealth inequality and populism in America and the recent surge in union activity. In our project, we find that all three metrics are related. Using regression testing we show that for unions and political leanings, this relationship has surged and deepened in the last four decades from 1984 to 2019"
#bibliography: main.bib
---

```{r setup}
#| echo: false
#| message: false

library(parameters)
library(tidyverse)
library(usmap)
```

```{r}
#| echo: false
#| message: false

# Read data

## Union Data: obtained from Tidy Tuesday
union_wages <- read_rds("../Data/union_wages.rds")
union_states <- read_rds("../Data/union_states.rds")

## Election Data: Obtained from Tidy Tuesday
house <- read_rds("../Data/house.rds")

## Wage Data: Obtained from Tidy Tuesday
income_distribution <- read_rds("../Data/income_distribution.rds")

## Minimum Wage Data: Obtained from U.S. Department of Labor
minimum_wage <- read_csv("../Data/minimum_wage_data.csv",show_col_types = FALSE)


# Clean data

## house data
house <- house |>
  group_by(year, state, district) |> # group for next line
  filter(candidatevotes == max(candidatevotes)) |> #only include candidates that won
  ungroup() |> 
  mutate(state = str_to_sentence(state)) |> # change from all caps to sentence case) 
  select(!(state_fips:office)) |> #Remove unwanted columns
  select(!(stage:candidate)) |> 
  select(!(writein:fusion_ticket)) |> 
  rename(state_abbreviation = state_po) |>  # rename state abbreviation column
  mutate(party = case_when( # Recode of party variable
    str_detect(party, "DEMOCRAT") ~ "DEMOCRAT",
    str_detect(party, "REPUBLICAN") ~ "REUBLICAN",
    str_detect(party, "INDEPENDENT") ~ "INDEPENDENT"
  )) |> 
  filter(state_abbreviation != "DC") # Removes the single line of DC data

## union wages data
union_wages <- union_wages |> 
  filter(facet == "all wage and salary workers") |> 
  distinct(year, .keep_all = TRUE) |> 
  select(-sample_size,
         -at_cap) |> 
  mutate(wage_percent_difference = union_wage_premium_raw, .keep = "unused") |> 
  mutate(wage_percent_difference_adjusted = union_wage_premium_adjusted, .keep = "unused") |> 
  mutate(union_type = facet, .keep = "unused")

## union states data
union_states <- union_states |> 
  select(-state_census_code,
         -observations) |> # remove unwanted columns
  mutate(employment_count = employment * 1000, .keep = "unused") |> # column measured in 1000s, this fixes it
  mutate(union_employment_count = members * 1000, .keep = "unused") |> 
  mutate(collective_bargain_employment_count = covered * 1000,
         .keep = "unused") |> 
  rename(
    percent_union = p_members,
    percent_collective_bargain = p_covered
  ) #renamed columns

## income distribution data
income_distribution <- income_distribution |> 
  select(-number) |> # removing unwanted columns
  select(!ends_with("moe")) |> 
  select(year:income_mean) |> 
  distinct(year, race, income_median, income_mean, .keep_all = TRUE) |> # only include one line per year. needed bc of multiple sectors that are not being used in data analysis
  rename(median_income = income_median,
         mean_income = income_mean) |> # renaming columns
  filter(race == "All Races") |> 
  select(-race)

## minimum wage data
minimum_wage <- minimum_wage |> 
  select(Year:CPI.Average) |> # selecting relevant columns
  rename(year = Year,
         state = State,
         state_min_wage = State.Minimum.Wage,
         state_min_wage_2020_adj = State.Minimum.Wage.2020.Dollars,
         fed_min_wage = Federal.Minimum.Wage,
         fed_min_wage_2020_adj = Federal.Minimum.Wage.2020.Dollars,
         effective_min_wage = Effective.Minimum.Wage,
         effective_min_wage_2020_adj = Effective.Minimum.Wage.2020.Dollars,
         CPI_avg = CPI.Average
  ) |> # renaming variables
  filter(!state %in% c("U.S. Virgin Islands", "Puerto Rico", "Guam")) |>  # remove territory
  mutate(state_abbreviation = 
           ifelse(is.na(state.abb[match(state, state.name)]),
                  "DC",
                  state.abb[match(state, state.name)]),
         .keep = "unused", .after = year) # replaces state with state abbreviation, NA values coded as DC as DC is the only NA value 


# Merging data frames

## state data frame
full_state_data <- union_states |> 
  filter(sector == "Total") |> 
  select(-sector,
         -state) |> 
  left_join(house, by = c("year", "state_abbreviation")) |> 
  mutate(decade = paste0((year - year %% 10), "s"),
         party_binary = ifelse(party == "DEMOCRAT", 1, 0)) |> 
  left_join(minimum_wage, by = c("year", "state_abbreviation")) |> 
  group_by(year, state) |> 
  mutate(party_state_average = mean(party_binary)) |>
  ungroup() |> 
  mutate(state = state.name[match(state_abbreviation, state.abb)], # fix state encoding
         regions = state.region[match(state_abbreviation, state.abb)]) |>  # fix region encoding
  filter(year >= 1984 & year <= 2019) |> 
  filter(state_abbreviation != "DC") # Removes the single line of DC data

state_column_list = c("year", "decade", "state", "state_abbreviation",
                      "regions", "district", "party", "party_binary",
                      "party_state_average",
                      "employment_count", "union_employment_count",
                      "collective_bargain_employment_count", "percent_union",
                      "percent_collective_bargain", "state_min_wage",
                      "state_min_wage_2020_adj", "fed_min_wage",
                      "fed_min_wage_2020_adj", "effective_min_wage",
                      "effective_min_wage_2020_adj", "CPI_avg")
full_state_data <- full_state_data[, state_column_list] # reorder columns
full_state_data$party[is.na(full_state_data$party)] <- "No election" # replace party NAs
full_state_data$district[is.na(full_state_data$district)] <- "No election" # replace district NAs
full_state_data$party_binary[is.na(full_state_data$party_binary)] <- "No election" # replace district NAs

## national data frame
state_to_ntl_adjusted <- full_state_data |>
  mutate(prop_2020_adj = fed_min_wage_2020_adj / fed_min_wage, .after = year) |>
  distinct(year, .keep_all = TRUE) |>
  select(year, prop_2020_adj)

state_to_ntl_employment <- full_state_data |>
  group_by(year) |>
  summarise_at(vars(employment_count:collective_bargain_employment_count), sum)

full_ntl_data <- income_distribution |> 
  left_join(union_wages, by = "year") |>
  left_join(state_to_ntl_adjusted, by = "year") |>
  left_join(state_to_ntl_employment, by = "year") |>
  mutate(decade = paste0((year - year %% 10), "s"), .after = year) |>
  mutate(mean_median_income_difference = mean_income - median_income, .after = mean_income) |>
   mutate(median_income_2020_adj = median_income * prop_2020_adj,
         mean_income_2020_adj = mean_income * prop_2020_adj,
         mean_median_income_difference_2020_adj = mean_median_income_difference * prop_2020_adj,
         wage_2020_adj = wage * prop_2020_adj,
         union_wage_2020_adj = union_wage * prop_2020_adj,
         nonunion_wage_2020_adj = nonunion_wage * prop_2020_adj,
         percent_union = union_employment_count / employment_count,
         percent_collective_bargain = collective_bargain_employment_count / employment_count) |> 
  select(-prop_2020_adj) |> 
  filter(year >= 1984 & year <= 2019)

ntl_column_list <- c("year", "decade", "mean_income",
                     "mean_income_2020_adj", "median_income",
                     "median_income_2020_adj", "mean_median_income_difference",
                     "mean_median_income_difference_2020_adj", "wage",
                     "wage_2020_adj", "union_wage", "union_wage_2020_adj",
                     "nonunion_wage", "nonunion_wage_2020_adj",
                     "wage_percent_difference", 
                     "wage_percent_difference_adjusted",
                     "employment_count", "union_employment_count", 
                     "collective_bargain_employment_count",
                     "percent_union", "percent_collective_bargain",
                     "union_type")
full_ntl_data <- full_ntl_data[, ntl_column_list] # reorder columns

rm(house, income_distribution, minimum_wage, state_to_ntl_adjusted,
   state_to_ntl_employment, union_states, union_wages, state_column_list,
   ntl_column_list)

```


# Introduction

Unions play a crucial role in negotiating wages and benefits for workers through collective bargaining agreements. The political landscape, particularly the House of Representatives, holds significant legislative authority in influencing workers' rights and labor policies. We examine the relationship between unions and collective bargaining agreements, U.S. House of Representatives election results, and economic variables including the incomes and wages of Americans. These project topics are motivated by the recent surge in union activity, increased political polarization, and a rise in wealth inequality.


In this paper, we use three research questions to guide our analysis:

1.  Is there any relationship between collective bargaining rates among workers to house delegation makeup?
2.  Is there any relationship between collective bargaining rates among workers and wages?
3.  Do collective bargaining rates effect wealth inequality?

Guided by our research questions, we have two hypothesis: 

1.    There is a significant correlation between collective bargaining rates and higher amounts of Democrat representation in the House of Representatives. 
2.    Unions will lead to higher wages.

We use five data sets that are joined into two data frames to explore our research questions. We create a data frame that stores information at the national level about income and union wages, and a data frame that stores information at the state level about minimum wages, union employment, and House election results.

When conducting a regression analysis, it demonstrates that the correlation between collective bargaining and political representation in the House has gotten stronger in the last four decades from 1984 to 2019. Additionally, when conducting t-tests among union and non union wages, there is a statistically significant difference that demonstrates an increasing wage differential over the same time period.


# \[Our Substance and Context Section Title Here\]

Here we go deeper into the intellectual debate, the political and social context of our investigation. To give the reader a clear sense of why we are writing this paper, we describe the relevant scholarly, technical, or popular literature. We give this section a meaningful *substantive* title; it is not entitled "Literature Review", for example. We cite at least three published, peer-reviewed scholarly works. For example, we could cite @mooree20 or @moorav12[^1], which we discussed in class.[^2] We only cite others' work in our paper when it enhances the reader's understanding of what we, the authors of this paper, are doing. We connect everything we cite to *our* investigation; this is our original research, not a book report or an annotated bibliography.

[^1]: There should always be a space before the "(" in a citation date.

[^2]: To cite a paper within parentheses, use, e.g., [@moore12].

We do not cite paper titles or journal names, unless our paper is about someone else's paper or about the set of articles in a journal. We do not cite authors' first, given names. We can refer to either what an author does, or what a paper does, but we should be consistent. For example, "@moorav12 argue that we should \ldots" refers to what the authors do; "@moorav12 argues that we should \ldots" refers to what the paper -- @moorav12 -- does.

In order to integrate citations into the References section below, we add entries into our file `main.bib`. This is a plain-text file that we edit in RStudio. We store `main.bib` in the same folder as our paper's `.qmd` and `.pdf` files. Its entries are formatted so that they can be knit to `.pdf`; see [https://j.mp/2UzTXEZ](https://www.overleaf.com/learn/latex/Bibliography_management_with_bibtex#The_bibliography_file) for example entries for articles, books, and miscellaneous. We can get these entries automatically from Google Scholar by turning on BibTeX in the Google Scholar Settings - Bibliography Manager. Perhaps we use a tool like free, open-source BibDesk to help us manage the `.bib` file.

# Data and Methods {#sec-data}

The data being analyzed is from a collection of five data sets. The first two data sets, `union_wages` and `union_states` are gathered from Tidy Tuesday, although the original data comes from the Union Membership and Coverage Database at Georgia State University. The  tables relevant to this paper detail union membership counts by state and year, as well as union and non union wages nationally. The third data set, `house`, is also from Tidy Tuesday, although the original data comes from the MIT Election Data and Science Lab. The data includes every person who ran for a seat in the House of Representatives, but we only selected the election winner. The fourth data set, `income_distribution`, is also from Tidy Tuesday, although the original data comes from the U.S. Census. The data tracks the mean and median income nationally in the United States. The fifth data set, `minimum_wage`, comes from the U.S. Department of Labor and tracks minimum wage at the state level and the federal minimum wage.

All of the data sets undergo basic cleaning so that the columns are correctly formatted, variable names are consistent, so there are no NA values, and relevant variables are selected. For the house election data, the table is manipulated so that only rows of candidates who won their election remain. A binary variable is created in which we code the outcome as 1 if the winner was a Democrat and code the outcome as 0 if the winner was a Republican. An additional variable is created to show the proportion of the House delegation that is democratic for every combination of years and states. For the union data, it is filtered to not include union sectors, such as construction unions, and instead look at all unions. For the income distribution data, race is filtered out because it is outside of the scope of this study.

The five data sets are combined into two data sets: one that stores data at the state level and another that stores data at the national level. `full_state_data` joins the `union_states`, `house`, and `minimum_wage` data sets. There are `8730` observations and each row represents a year and a state. `full_ntl_data` joins the `union_wages` and `income_distribution` data sets. There are `36` observations and each row represents a distinct year. Variables regarding union employment are not provided at the national level, only at the state level, so they were summarized and added to the national data set. Economic variables in the national data are not originally adjusted to 2020 values, so we calculate the rate from the state data that contains adjusted and non-adjusted values for federal minimum wage, and then apply that rate to the national data. This allows all of the economic data to be standardized and account for inflation. Among the original five data sets, there is data recorded from 1967 to 2022. Not all of the data sets cover that time frame, so once joined into two data sets, the data was filtered to only include the years 1984 to 2019. 

With two cleaned data sets, we conduct our exploratory data analysis using R version `r paste(R.version$major, R.version$minor, sep = ".")` [@rcoreteam23]. We rely on several elements of the `tidyverse` [@wickhamtidyverse].






We cite our data. We describe the methods we use to answer our question and to test our hypotheses.

"Our outcome is stopping distance measured in feet." We state our key predictor and how it is measured: "Our key predictor is the car's speed, measured in miles per hour."

We almost never refer to specific variable, object, function, or data frame names (such as `var_x`, `ourdata`, `this_useful_func`, or `df`). These particular names are almost never of interest or use to the reader.


## Union Data

```{r fig-uniondata}
#| echo: false
#| warning: FALSE
#| fig-cap: Union Data

per_collective_wage_data <- full_state_data |> # This object will be used to create the graph and also in the data subset
  mutate(
    map_color = case_when(
      state_abbreviation == "CA" ~ "CA", # States we would like to highlight. first "" is the state abb, second "" is what will appear in legend
      state_abbreviation == "AK" ~ "AK",
      state_abbreviation == "HI" ~ "HI",
      state_abbreviation == "FL" ~ "FL",
      .default = NA
    )
  ) 

per_collective_wage_data |> # use created table here
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_collective_bargain, group = state_abbreviation),
            color = "grey75", alpha =0.6) + # using group means the groupings wont appear in legend
  geom_line(data = subset(per_collective_wage_data, # use created object here
                          !is.na(map_color)), #subset used to keep out non highlighted states
            aes(y = percent_collective_bargain, color = map_color),
            linewidth = .75) +
  geom_line(data = subset(full_ntl_data, year >= 1984),
            aes(y = percent_collective_bargain), color = "orange", linewidth = 1.5) +
  annotate("text", x=1988, y=.17, label= "Federal Avg", color = "orange", size = 5) +
  theme_minimal() +
  scale_x_continuous(breaks = seq(min(per_collective_wage_data$year), max(per_collective_wage_data$year), by = 4)) + 
  labs(title = "States by % of Labor Market Covered by a Collective Bargaining Agreement",
       x = "Year",
       y = "% of Labor Market in a Collective Bargaining Agreement",
       color = "Selected States")
```

## Income Data
```{r fig-incomedata}
#| echo: false
#| warning: FALSE
#| fig-cap: Income Data

full_ntl_data |> 
  filter(year >= 1984) |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = mean_income), color = "red") +
  annotate("text", x=1995, y=85000, label= "Mean income", color = "red", size = 5) +
  geom_line(aes(y = median_income), color = "blue") +
  annotate("text", x=1995, y=65000, label= "Median income", color = "blue", size = 5) +
  scale_x_continuous(breaks = seq(min(full_ntl_data$year), max(full_ntl_data$year), by = 4)) + 
  theme_minimal() +
  labs(
    title = "Mean and Median Income in the United States Between 1984 and 2019",
    x = "Year",
    y = "Income in USD"
  )
```

```{r fig-incomedataadj}
#| echo: false
#| warning: FALSE
#| fig-cap: Income Data (adjusted)

full_ntl_data |> 
  filter(year >= 1984) |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = mean_income_2020_adj), color = "red") +
  annotate("text", x=1995, y=145000, label= "Mean income", color = "red", size = 5) +
  geom_line(aes(y = median_income_2020_adj), color = "blue") +
  annotate("text", x=1995, y=115000, label= "Median income", color = "blue", size = 5) +
  scale_x_continuous(breaks = seq(min(full_ntl_data$year), max(full_ntl_data$year), by = 4)) + 
  theme_minimal() +
  labs(
    title = "Mean and Median Income in the United States Between 1984 and 2019 (2020 USD)",
    x = "Year",
    y = "Income in USD (Adjusted to 2020 values)"
  )
```

```{r fig-wagedata}
#| echo: false
#| warning: FALSE
#| fig-cap: Wage Data

effective_minimum_wage_data <- full_state_data |> 
  filter(effective_min_wage_2020_adj != fed_min_wage_2020_adj) |> 
  mutate(
    map_color = case_when(
      state_abbreviation == "CA" ~ "CA",
      state_abbreviation == "AK" ~ "AK",
      state_abbreviation == "CT" ~ "CT",
      state_abbreviation == "HI" ~ "HI",
      .default = NA
    )
  ) 

effective_minimum_wage_data |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = effective_min_wage_2020_adj, group = state_abbreviation),
            color = "grey75", alpha =0.6) +
  geom_line(data = subset(effective_minimum_wage_data, !is.na(map_color)),
            aes(y = effective_min_wage_2020_adj, color = map_color),
            linewidth = .75) +
  geom_line(aes(y = fed_min_wage_2020_adj), color = "orange", linewidth = 1.5) +
  annotate("text", x=1990, y=6, label= "Federal Avg", color = "orange", size = 5) +
  theme_minimal() +
  scale_x_continuous(breaks = seq(min(effective_minimum_wage_data$year), max(effective_minimum_wage_data$year), by = 4)) + 
  labs(title = "State Effective Minimum Wage by Year (Adjusted for 2020 $)",
       subtitle = "For states with an adjusted effective minimum wage above the federal level",
       x = "Year",
       y = "Effective Minimum Wage (Adjusted to 2020 values)",
       color = "Selected States")
```

## House of Representatives Data

```{r fig-housedata}
#| echo: false
#| warning: FALSE
#| fig-cap: House Data

map_data <- full_state_data |> 
  select(c("year", "state", "party_state_average")) |> 
  distinct(year, state, .keep_all = TRUE) |> 
  filter(year %% 4==0) |> 
  filter(!is.na(party_state_average)) |> 
  full_join(
    tibble(
      "year" = seq(from=1984, to=2016, by=4),
      "state" = rep("District of Columbia", 9),
      "party_state_average" = rep(.5, 9)),
    by = c("year", "state", "party_state_average")
    )

plot_usmap(data = map_data, values = "party_state_average", color = "black") +
  facet_wrap(~year, nrow = 4, ncol= 3) +
  theme(legend.position = "bottom") +
  scale_fill_gradient(low = "red", high = "blue", name = "Proportion") +
  labs(
    title = "Proportion of House Delegation that is Democratic"
  )
```

## Collective Bargaining and Wage Data

```{r fig-unionwagedata}
#| echo: false
#| warning: FALSE
#| fig-cap: Union Wage Data

full_ntl_data |> 
  ggplot(aes(x = year)) +
  geom_line(aes(y = union_wage_2020_adj), color = "blue") +
  annotate("text", x=1993, y=28, label= "Union Wages", color = "blue", size = 5) +
  geom_line(aes(y = nonunion_wage_2020_adj), color = "red") +
  annotate("text", x=1993, y=22, label= "Non Union Wages", color = "red", size = 5) +
  scale_x_continuous(breaks = seq(min(full_ntl_data$year), max(full_ntl_data$year), by = 4)) + 
  theme_minimal() +
  labs(
    title = "Union vs. Non Union Wages Over Time",
    x = "Year",
    y = "Wages (Adjusted to 2020 values)"
  )
```

```{r fig-collectivebargain}
#| echo: false
#| warning: FALSE
#| fig-cap: Collective Bargain Data

full_ntl_data |> 
  ggplot(aes(x = percent_collective_bargain)) +
  geom_point(aes(y = nonunion_wage_2020_adj), color = "blue") +
  geom_jitter(aes(y = union_wage_2020_adj), color = "red") +
  theme_light() +
  facet_wrap(~decade) +
  labs(
    title = "Union vs. Non-Union Wages by Decade",
    subtitle = "Red represents union wages and blue represents non-union wages",
    x = "Percent of Workers Under Collective Bargaining Agreement",
    y = "Wages (Adjusted to 2020 values)"
  )
```

## Collective Bargaining and House of Representatives Data

```{r fig-collectivebargaindecade}
#| echo: false
#| warning: FALSE
#| fig-cap: Collective Bargain Data by Decade

full_state_data |> 
  filter(year %% 4==0) |>
  ggplot(aes(x = percent_collective_bargain, y = party_state_average)) +
  geom_jitter(aes(color = regions), alpha = 0.5, width = 0.1, height = 0.1) +
  geom_smooth(method = "lm", color = "black") +
  facet_wrap(~decade) +
  theme_light() +
  labs(
    title = "% Collective Bargaining vs Proportion of House Delegation That is Democratic",
    x = "Percent of Workers Covered by Collective Bargaining",
    y = "Proportion of House Delegation that is Democratic",
    color = "Region"
  )
```

```{r fig-collectivebargainregion}
#| echo: false
#| warning: FALSE
#| fig-cap: Collective Bargain Region by Decade and Region

full_state_data |> 
  filter(year %% 4==0) |>
  ggplot(aes(x = percent_collective_bargain, y = party_state_average)) +
  geom_jitter(aes(color = regions), alpha = 0.15, width = 0.1, height = 0.1) +
  geom_smooth(method = "lm", aes(group = regions, color = regions), se = FALSE) +
  facet_wrap(~decade) +
  theme_light() +
  labs(
    title = "% Collective Bargaining vs Proportion of House Delegation That is Democratic",
    subtitle = "Regressed by Region",
    x = "Percent of Workers Covered by Collective Bargaining",
    y = "Proportion of House Delegation that is Democratic",
    color = "Region"
  )
```



# Exploring Correlations: Linear Regression Analyses and T-Tests on Collective Bargaining and Wage Disparities

Based on our exploratory data analysis, we are conducting linear regression analyses and t-tests. The linear regressions use data from `full_state_data` and explore how collective bargaining agreements are correlated with Democratic representatives being elected to the House in all four regions. The results are used to examine if the north central region and southern region are driving this stronger correlation over time. Additionally, the t-test uses data from `full_ntl_data` to understand if the observed variations in wages between unionized and non-unionized workers are statistically meaningful. By looking at different decades, we aim to analyze potential shifts in wage consistencies or differences over time. This provides insight into the dynamics of the labor market.


## Predicting Democratic House Delegations with Percentage of Workers in Collective Bargaining Argreements

@tbl-linear performs a linear regression between the percent of workers in a collective bargaining agreement and the proportion of the House delegation that is Democratic for the 1980s and 2010s in each region, as well as for all of the regions combined 

```{r linearmodel}
#| echo: false

decade_region <- list(
  c("1980s", "Northeast"),
  c("1980s", "West"),
  c("1980s", "North Central"),
  c("1980s", "South"),
  c("2010s", "Northeast"),
  c("2010s", "West"),
  c("2010s", "North Central"),
  c("2010s", "South")
)
                  
regression_decade_region <- function(decade1, region1) {
  full_state_data_filtered <- subset(full_state_data, regions == region1 & decade == decade1)
  model <- lm(full_state_data_filtered$party_state_average~full_state_data_filtered$percent_collective_bargain) 
  summary(model)$coefficients |> 
  as_tibble() |> 
  mutate(Reggression_Run = c("Intercept", "percent_collective_bargain"),
         Decade = c(decade1, decade1),
         Region = c(region1, region1),
         .before = Estimate)
}  

full_state_data_temp <- full_state_data |>
  filter(year >= 1984 & year < 1990)
CB_party_regression <- summary(lm(full_state_data_temp$party_state_average~full_state_data_temp$percent_collective_bargain))$coefficients |> 
  as_tibble() |> 
  mutate(Reggression_Run = c("Intercept", "percent_collective_bargain"),
         Decade = c("1980s", "1980s"),
         Region = c("all", "all"),
         .before = Estimate)

for (x in decade_region) {
  CB_party_regression <- full_join(CB_party_regression, regression_decade_region(x[1], x[2]),
                                   by = join_by(Reggression_Run, Decade, Region, Estimate, `Std. Error`, `t value`, `Pr(>|t|)`))
}

full_state_data_temp <- full_state_data |>
  filter(year >= 2010 & year < 2020)
CB_party_temp <- summary(lm(full_state_data_temp$party_state_average~full_state_data_temp$percent_collective_bargain))$coefficients |> 
  as_tibble() |> 
  mutate(Reggression_Run = c("Intercept", "percent_collective_bargain"),
         Decade = c("2010s", "2010s"),
         Region = c("all", "all"),
         .before = Estimate)

CB_party_regression <- full_join(CB_party_regression, CB_party_temp,
                                   by = join_by(Reggression_Run, Decade, Region, Estimate, `Std. Error`, `t value`, `Pr(>|t|)`)) |>
  filter(Reggression_Run == "percent_collective_bargain") |>
  rename(P_Value = "Pr(>|t|)")

```

```{r tbl-linear}
#| echo: false
#| message: false
#| results: 'asis'
#| tbl-cap: Linear Regression

regr_table <- xtable::xtable(CB_party_regression,
                             digits = 2)

print(regr_table, comment = FALSE)
```

For all linear regressions, $p < 0.05$, except for in the 1980s when examining `all` regions, $p = 0.659$.

```{r fig-estimates}
#| echo: false
#| fig-cap: Linear Regression Estimates

ggplot(CB_party_regression, aes(x = Decade, y = Estimate, fill = Region)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = sprintf("P=%.3f", P_Value)),
             position = position_dodge(width = 0.9),
             vjust = -0.2,
             size = 2) +
  theme_minimal() +
  labs(title = "Linear Regression Estimate by Decade",
       subtitle = "Model of Percent Collective Bargaining vs Democratic House Proportion")
```

@fig-estimates plots the `Estimate` values calculated in the linear regressions.
The regression analysis shows that the south and north central regions in the United States are the main regions that have seen union membership rates and political leanings show increased correlation. The south and north central regions have the greatest increase in their estimate values from the 1980s to the 2010s among the four regions.


## Comparing Wages between Union and Non Union Workers

Our results seen in @tbl-ttest for these t-tests determine if there is a statistically significant difference between union wages and non union wages in the 1980s and the 2010s.

```{r ttest}
#| echo: FALSE

# 1980s
full_ntl_data_1980s <- full_ntl_data |>
  filter(decade == "1980s")
t_out_1980s <- t.test(full_ntl_data_1980s$nonunion_wage_2020_adj, full_ntl_data_1980s$union_wage_2020_adj)

t_lower_ci_1980s <- t_out_1980s$conf.int[1] |> round(2)
t_upper_ci_1980s <- t_out_1980s$conf.int[2] |> round(2)

# 2010s
full_ntl_data_2010s <- full_ntl_data |>
  filter(decade == "2010s")
t_out_2010s <- t.test(full_ntl_data_2010s$nonunion_wage_2020_adj, full_ntl_data_2010s$union_wage_2020_adj)

t_lower_ci_2010s <- t_out_2010s$conf.int[1] |> round(2)
t_upper_ci_2010s <- t_out_2010s$conf.int[2] |> round(2)
```

The difference between union wages and non union wages means in the 1980s is `r t_out_1980s$estimate[2] - t_out_1980s$estimate[1]`, with a 95% confidence interval that covers $(`r -t_upper_ci_1980s`, `r -t_lower_ci_1980s`)$. The difference between union wages and non union wages means in the 2010s is `r t_out_2010s$estimate[2] - t_out_2010s$estimate[1]`, with a 95% confidence interval that covers $(`r -t_upper_ci_2010s`, `r -t_lower_ci_2010s`)$. The 95% confidence interval for the 1980s has a smaller range than the 95% confidence interval for the 2010s.


```{r tbl-ttest}
#| echo: FALSE
#| warning: FALSE
#| tbl-cap: Wages by Union and Non Union Workers

tab <- tibble(
  "metric" = c("t", "df", "p-value", "95%-CI-LB", "95%-CI-UB", "Mean_of_X", 
               "Mean_of_Y"),
  "t_out_1980s" = c(t_out_1980s$statistic, t_out_1980s$parameter, t_out_1980s$p.value, t_out_1980s$conf.int, t_out_1980s$estimate),
  "t_out_2010s" = c(t_out_2010s$statistic, t_out_2010s$parameter, t_out_2010s$p.value, t_out_2010s$conf.int, t_out_2010s$estimate)) 

tab |> 
  print_md(
    footer = "")
```

# Discussion

From our data analysis it can be inferred that collective bargaining agreements have become a very political concept. The charts in our exploratory data analysis and regression models show this. This partially supports our hypothesis. While the correlation is a newer phenomenon, the relationship appears to be strong today. The relationship between unions and wages/income in the United States is much harder to draw inferences. While our t-tests and some charts show that unions can help workers earn more, other graphs show that unions have a negative effect on incomes. Our second hypothesis thus remains without strong support.




-   Union wage data at the state level
-   Data past 2019
-   A greater amount and complexity of models

We remind the reader what this paper was about, why it was important, and what we found. We reflect on limitations of the data or methods. If we have specific advice for someone picking up where we leave off, we provide that guidance. We avoid making trite statements like "more research should be done".

\clearpage

# References
